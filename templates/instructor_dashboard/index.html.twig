{% extends 'base.html.twig' %}

{% block title %}Instructor Dashboard — CompileX{% endblock %}

{% block body %}
<script src="https://cdn.tailwindcss.com"></script>
<script>
  tailwind.config = { darkMode: 'class' };
  const DARK_KEY = 'compilex-dark-mode';
  function loadInitialTheme() {
    const saved = localStorage.getItem(DARK_KEY);
    document.documentElement.classList.toggle('dark', saved === 'true');
  }
  document.addEventListener('DOMContentLoaded', loadInitialTheme);
</script>

<div id="app" class="flex min-h-screen bg-slate-50 text-gray-900 dark:bg-gray-900 dark:text-gray-100">

  <!-- Sidebar -->
  <aside id="sidebar"
         class="fixed top-0 left-0 z-50 h-full w-64 bg-slate-800 text-white dark:bg-gray-800 transform -translate-x-full transition-transform duration-300 flex flex-col">
    <div class="px-6 py-5 border-b border-slate-700 dark:border-gray-700 flex items-center justify-between">
      <h2 class="text-xl font-semibold tracking-tight">CompileX Instructor</h2>
      <button class="text-2xl md:text-3xl focus:outline-none" onclick="toggleSidebar()">×</button>
    </div>

    <nav class="flex-1 px-4 py-4 space-y-1">
      <a href="{{ path('home') }}"
         class="block px-3 py-2 rounded-md font-medium hover:bg-slate-700 dark:hover:bg-gray-700">
        Home
      </a>

      {% if is_granted('ROLE_ADMIN') %}
        <a href="{{ path('app_admin') }}"
           class="block px-3 py-2 rounded-md font-medium hover:bg-slate-700 dark:hover:bg-gray-700">
          Admin Dashboard
        </a>
      {% endif %}

      <a href="{{ path('app_instructor_dashboard') }}"
         class="block px-3 py-2 rounded-md font-medium bg-slate-700 dark:bg-gray-700 hover:bg-slate-600 dark:hover:bg-gray-600">
        Instructor Dashboard
      </a>

      <div class="pt-4 border-t border-slate-700 dark:border-gray-600 mt-4">
        <button id="mode-toggle"
                class="mt-2 block w-full text-left px-3 py-2 rounded-md font-medium hover:bg-slate-700 dark:hover:bg-gray-700">
          Toggle Light/Dark Mode
        </button>
        <a href="{{ path('app_logout') }}"
           class="block mt-2 px-3 py-2 rounded-md font-medium text-red-500 hover:bg-red-700">
          Logout
        </a>
      </div>
    </nav>
  </aside>

  <!-- Main -->
  <div class="flex-1 flex flex-col min-h-screen">
    <header class="fixed top-0 left-0 w-full z-40 bg-slate-800 text-white dark:bg-gray-800 flex items-center justify-between px-6 py-3 shadow-md">
      <h1 class="text-xl font-semibold text-blue-400 dark:text-blue-300 tracking-tight">CompileX</h1>
      <button class="text-2xl md:text-3xl focus:outline-none" aria-label="Toggle menu" onclick="toggleSidebar()">
        <span id="burger-icon">&#9776;</span>
      </button>
    </header>

    <div class="h-16"></div>

    <main id="main-content" class="flex-1 p-8 space-y-6">

      <!-- Top: welcome -->
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div>
          <h2 class="text-3xl font-semibold">Instructor Dashboard</h2>
          <p class="text-sm text-gray-600 dark:text-gray-300 mt-1">
            Welcome{% if user %}, {{ user.email }}{% endif %}. This area is reserved for instructor tools and course management.
          </p>
        </div>
      </div>

      <!-- Stats cards (placeholder for now) -->
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
        <div class="rounded-xl border border-slate-200 dark:border-slate-700 bg-white/80 dark:bg-slate-800/80 p-4 shadow-sm">
          <p class="text-sm text-gray-500 dark:text-gray-400">Total Courses</p>
          <p class="mt-2 text-2xl font-semibold">–</p>
          <p class="mt-1 text-xs text-gray-400 dark:text-gray-500">Future: show assigned courses</p>
        </div>

        <div class="rounded-xl border border-slate-200 dark:border-slate-700 bg-white/80 dark:bg-slate-800/80 p-4 shadow-sm">
          <p class="text-sm text-gray-500 dark:text-gray-400">Total Subjects</p>
          <p class="mt-2 text-2xl font-semibold">–</p>
          <p class="mt-1 text-xs text-gray-400 dark:text-gray-500">Future: subjects handled by instructor</p>
        </div>

        <div class="rounded-xl border border-slate-200 dark:border-slate-700 bg-white/80 dark:bg-slate-800/80 p-4 shadow-sm">
          <p class="text-sm text-gray-500 dark:text-gray-400">Enrolled Students</p>
          <p class="mt-2 text-2xl font-semibold">–</p>
          <p class="mt-1 text-xs text-gray-400 dark:text-gray-500">Future: per-course/student stats</p>
        </div>
      </div>

      <!-- Placeholder table -->
      <div class="rounded-xl border border-slate-200 dark:border-slate-700 bg-white/80 dark:bg-slate-800/80 p-4 shadow-sm">
        <div class="flex items-center justify-between mb-3">
          <h3 class="font-semibold text-lg">Upcoming Classes (Placeholder)</h3>
          <span class="text-xs text-gray-500 dark:text-gray-400">No data yet</span>
        </div>
        <p class="text-sm text-gray-600 dark:text-gray-300">
          This section can later show upcoming sessions, deadlines, or tasks assigned to this instructor.
        </p>
      </div>

    </main>
  </div>
</div>

<script>
const sidebar = document.getElementById('sidebar');
const burgerIcon = document.getElementById('burger-icon');
const DARK_KEY = 'compilex-dark-mode';
const modeToggle = document.getElementById('mode-toggle');

function toggleSidebar() {
  sidebar.classList.toggle('-translate-x-full');
  burgerIcon.innerHTML = sidebar.classList.contains('-translate-x-full') ? '&#9776;' : '&times;';
}

function loadInitialThemeJS() {
  const saved = localStorage.getItem(DARK_KEY);
  document.documentElement.classList.toggle('dark', saved === 'true');
}
loadInitialThemeJS();

modeToggle.addEventListener('click', e => {
  e.stopPropagation();
  const isDark = document.documentElement.classList.contains('dark');
  document.documentElement.classList.toggle('dark', !isDark);
  localStorage.setItem(DARK_KEY, (!isDark).toString());
});

document.addEventListener('click', e => {
  if (!sidebar.contains(e.target) &&
      !e.target.closest('button[aria-label="Toggle menu"]') &&
      !sidebar.classList.contains('-translate-x-full')) {
    toggleSidebar();
  }
});

document.addEventListener('keydown', e => {
  if (e.key === 'Escape' && !sidebar.classList.contains('-translate-x-full')) {
    toggleSidebar();
  }
});
</script>
{% endblock %}
